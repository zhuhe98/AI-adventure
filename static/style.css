/* 基础样式 */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  image-rendering: pixelated;
}

@font-face {
  font-family: 'VT323';
  font-style: normal;
  font-weight: 400;
  src: url(https://fonts.gstatic.com/s/vt323/v12/pxiKyp0ihIEF2isQFJXGdg.woff2) format('woff2');
}

body {
  /* 使用更通用的字体组合，确保中文显示 */
  font-family: 'VT323', 'Microsoft YaHei', '微软雅黑', 'SimHei', '黑体', sans-serif;
  background-color: #f0e6c8; /* 淡淡的牛皮纸颜色 */
  color: #3d2813; /* 更深的文本颜色，增强对比度 */
  line-height: 1.5;
  min-height: 100vh;
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAEklEQVQImWNgYGD4z0AswK4SAFXuAf8EPy+xAAAAAElFTkSuQmCC');
  background-repeat: repeat;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 1rem;
  height: 100vh;
  display: flex;
  flex-direction: column;
}

/* 像素风格的边框 */
.pixel-border {
  border-style: solid;
  border-width: 4px;
  border-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><rect width="20" height="20" fill="%235c3e24"/><rect width="18" height="18" x="1" y="1" fill="%23b59d7c"/><rect width="16" height="16" x="2" y="2" fill="%235c3e24"/></svg>') 4 stretch;
}

/* 顶部标题 */
.header {
  text-align: center;
  margin-bottom: 1rem;
  padding: 0.75rem;
  background-color: #7d5c38; /* 木质颜色 */
  border-radius: 0;
  border: 4px solid #5c3e24;
  box-shadow: 0 4px 0 #3b2912; /* 深色阴影 */
}

.header h1 {
  font-size: 2rem;
  font-weight: normal;
  color: #f0e6c8; /* 淡牛皮纸色 */
  letter-spacing: 2px;
  text-shadow: 2px 2px 0 #3b2912;
}

/* 主要内容区域 */
.main-content {
  display: flex;
  flex: 1;
  gap: 1rem;
  overflow: hidden;
}

/* 故事和分支问题区域 */
.story-section {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 1rem;
  overflow: hidden;
}

/* 故事内容 */
.story-box {
  flex: 1;
  background-color: #f6ecd9; /* 淡淡的米色 */
  border-radius: 0;
  box-shadow: 0 6px 0 #5c3e24; /* 木质阴影 */
  overflow: hidden;
  display: flex;
  flex-direction: column;
  border: 4px solid #5c3e24;
}

/* 图像容器样式 */
#image-container {
  width: 100%;
  min-height: 180px;
  max-height: 300px;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  border-bottom: 4px solid #5c3e24;
  background-color: #cfb991; /* 浅木色 */
  padding: 1rem;
}

/* 故事图片 */
#story-image {
  max-width: 100%;
  max-height: 280px;
  object-fit: contain;
  border-radius: 0;
  border: 4px solid #5c3e24;
  box-shadow: 0 4px 0 #3b2912;
  transition: opacity 0.5s ease-in-out;
  image-rendering: crisp-edges;
}

.story-content {
  flex: 1;
  padding: 1.5rem;
  overflow-y: auto;
}

.story-text {
  white-space: pre-wrap;
  color: #3d2813; /* 加深文本颜色 */
  line-height: 1.7;
  font-size: 1.2rem;
  text-align: justify;
  /* 确保文本可见 */
  opacity: 1 !important;
  visibility: visible !important;
  display: block !important;
}

/* 分支问题区域 */
.branch-question {
  background-color: #f6ecd9;
  border-radius: 0;
  box-shadow: 0 6px 0 #5c3e24;
  border: 4px solid #5c3e24;
  padding: 1.25rem;
}

.branch-question h2 {
  font-size: 1.3rem;
  font-weight: normal;
  margin-bottom: 1rem;
  color: #3d2813; /* 加深文本颜色 */
  text-shadow: 1px 1px 0 #f0e6c8;
}

.branch-options {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
}

.branch-option {
  padding: 0.75rem 1.25rem;
  background-color: #8dc267; /* 星露谷的草绿色 */
  color: #f6ecd9;
  border: 0;
  border-radius: 0;
  border-bottom: 4px solid #5c8c3e; /* 深绿色底部边框 */
  font-size: 1.1rem;
  font-weight: normal;
  font-family: 'VT323', 'Microsoft YaHei', '微软雅黑', 'SimHei', '黑体', sans-serif;
  cursor: pointer;
  transition: all 0.2s ease;
  text-shadow: 1px 1px 0 #3b591f;
}

.branch-option:hover {
  background-color: #a4d678;
  transform: translateY(-2px);
  border-bottom-width: 6px;
}

.branch-option:active {
  transform: translateY(2px);
  border-bottom-width: 2px;
}

/* 角色介绍区域 */
.character-section {
  width: 300px;
  background-color: #f6ecd9;
  border-radius: 0;
  box-shadow: 0 6px 0 #5c3e24;
  border: 4px solid #5c3e24;
  padding: 1.25rem;
  overflow-y: auto;
}

.character-section h2 {
  font-size: 1.3rem;
  font-weight: normal;
  margin-bottom: 1rem;
  color: #3d2813; /* 加深文本颜色 */
  text-align: center;
  padding-bottom: 0.5rem;
  border-bottom: 2px solid #cfb991;
  text-shadow: 1px 1px 0 #f0e6c8;
}

.character-list {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.character-item {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  padding: 0.75rem;
  border-radius: 0;
  background-color: #e9daba;
  border: 2px solid #cfb991;
  transition: all 0.2s ease;
  cursor: pointer;
}

.character-header {
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

.character-avatar {
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 0;
  overflow: hidden;
  background-color: #cfb991;
  border: 3px solid #7d5c38;
  box-shadow: 2px 2px 0 #3b2912;
}

.character-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  image-rendering: crisp-edges;
}

.character-name {
  font-weight: normal;
  color: #3d2813; /* 加深文本颜色 */
  font-size: 1.1rem;
}

.character-description {
  font-size: 0.95rem;
  color: #3d2813; /* 加深文本颜色，不再使用淡色 */
  line-height: 1.4;
}

/* 输入区域 */
.input-section {
  background-color: #f6ecd9;
  border-radius: 0;
  box-shadow: 0 6px 0 #5c3e24;
  border: 4px solid #5c3e24;
  padding: 1rem;
  margin-top: 1rem;
}

.input-form {
  display: flex;
  gap: 0.5rem;
}

.input-field {
  flex: 1;
  padding: 0.75rem 1rem;
  border-radius: 0;
  border: 3px solid #7d5c38;
  background-color: #e9daba;
  font-size: 1.1rem;
  font-family: 'VT323', 'Microsoft YaHei', '微软雅黑', 'SimHei', '黑体', sans-serif;
  color: #3d2813;
  transition: all 0.2s ease;
}

.input-field:focus {
  outline: none;
  border-color: #8dc267;
  box-shadow: 0 0 0 2px rgba(141, 194, 103, 0.25);
}

.input-button {
  padding: 0.75rem 1.5rem;
  background-color: #e36956; /* 星露谷的红棕色 */
  color: #f6ecd9;
  border: 0;
  border-radius: 0;
  border-bottom: 4px solid #b34b3b; /* 深红色底部边框 */
  font-weight: normal;
  font-size: 1.1rem;
  font-family: 'VT323', 'Microsoft YaHei', '微软雅黑', 'SimHei', '黑体', sans-serif;
  cursor: pointer;
  transition: all 0.2s ease;
  text-shadow: 1px 1px 0 #8b3a2e;
}

.input-button:hover {
  background-color: #f37965;
  transform: translateY(-2px);
  border-bottom-width: 6px;
}

.input-button:active {
  transform: translateY(2px);
  border-bottom-width: 2px;
}

/* 响应式设计 */
@media (max-width: 768px) {
  .main-content {
    flex-direction: column;
  }

  .character-section {
    width: 100%;
    max-height: 200px;
  }

  #image-container {
    min-height: 150px;
    max-height: 200px;
  }

  #story-image {
    max-height: 180px;
  }

  .story-text {
    font-size: 1.1rem;
  }
}

.modal {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(92, 62, 36, 0.6);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    backdrop-filter: blur(2px);
}

.modal-content {
    background: #f6ecd9;
    padding: 2rem;
    border-radius: 0;
    box-shadow: 0 6px 0 #5c3e24, 0 0 20px rgba(0,0,0,0.2);
    max-width: 400px;
    width: 90%;
    text-align: center;
    position: relative;
    border: 4px solid #5c3e24;
}

.modal-content p, .modal-content li, .modal-content h3, .modal-content h4 {
    color: #3d2813;
    font-family: 'VT323', 'Microsoft YaHei', '微软雅黑', 'SimHei', '黑体', sans-serif;
}

.close-button {
    position: absolute;
    right: 1rem;
    top: 1rem;
    cursor: pointer;
    font-size: 1.5rem;
    color: #7d5c38;
    transition: 0.3s;
    font-family: 'VT323', 'Microsoft YaHei', '微软雅黑', 'SimHei', '黑体', sans-serif;
}

.close-button:hover {
    color: #e36956;
    transform: scale(1.2);
}

/* 鼠标悬停效果 */
.character-item:hover {
    background-color: #e3d2ac;
    box-shadow: 0 2px 6px rgba(92, 62, 36, 0.15);
    transform: translateY(-2px);
    border-color: #7d5c38;
}

/* 鼠标悬停时，人物名字变色 */
.character-item:hover .character-name {
    color: #8dc267;
}

/* 图片加载样式 */
#image-loading {
    color: #3d2813;
    font-size: 1.1rem;
    font-weight: normal;
    text-align: center;
}

/* 淡入效果 */
.story-box, .branch-question, .character-section, .input-section {
    animation: pixelFadeIn 0.5s steps(6) forwards;
}

@keyframes pixelFadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* 历史文本和新文本样式 */
.story-history, .story-text {
    white-space: pre-wrap;
    color: #3d2813;
    line-height: 1.6;
    font-size: 1.2rem;
    text-align: justify;
}

.story-history {
    margin-bottom: 1rem;
    color: #5c3e24; /* 深一些，但仍然可见 */
}

/* 加载动画 */
#loading-dots, #image-dots {
    font-family: 'VT323', 'Microsoft YaHei', '微软雅黑', 'SimHei', '黑体', sans-serif;
    font-size: 1.5rem;
    letter-spacing: 2px;
    color: #8dc267;
}

/* 自定义滚动条 */
::-webkit-scrollbar {
    width: 12px;
}

::-webkit-scrollbar-track {
    background: #e9daba;
}

::-webkit-scrollbar-thumb {
    background-color: #7d5c38;
    border: 3px solid #e9daba;
}

::-webkit-scrollbar-thumb:hover {
    background: #5c3e24;
}

/* 像素艺术效果 */
.pixel-art {
    image-rendering: pixelated;
    image-rendering: crisp-edges;
}

/* 游戏控制区域 */
.game-controls {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    margin-top: 0.75rem;
    padding: 0.5rem 1rem;
    background-color: #7d5c38;
    border: 3px solid #5c3e24;
    box-shadow: 0 3px 0 #3b2912;
    color: #f6ecd9;
}

.menu-button {
    padding: 0.4rem 1rem;
    background-color: #8dc267;
    color: #f6ecd9;
    border: 0;
    border-radius: 0;
    border-bottom: 3px solid #5c8c3e;
    font-family: 'VT323', 'Microsoft YaHei', '微软雅黑', 'SimHei', '黑体', sans-serif;
    font-size: 1rem;
    cursor: pointer;
    text-shadow: 1px 1px 0 #3b591f;
}

.menu-button:hover {
    background-color: #a4d678;
    transform: translateY(-2px);
}

.menu-option {
    padding: 0.75rem 1.25rem;
    margin: 0.5rem;
    width: 80%;
    background-color: #7d5c38;
    color: #f6ecd9;
    border: 0;
    border-bottom: 3px solid #5c3e24;
    font-family: 'VT323', 'Microsoft YaHei', '微软雅黑', 'SimHei', '黑体', sans-serif;
    font-size: 1.1rem;
    cursor: pointer;
}

.menu-option:hover {
    background-color: #8f6c43;
    transform: translateY(-2px);
}

.menu-buttons {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-top: 1rem;
}

/* 历史记录样式 */
/* 历史记录样式 */
.story-history {
    color: #7d5c38;
    margin-bottom: 1rem;
    font-size: 1.1rem;
}

.history-divider {
    border: none;
    border-top: 2px dashed #cfb991;
    margin: 1rem 0;
}

/* 控制按钮 */
.game-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 0.75rem;
    padding: 0.5rem 1rem;
    background-color: #7d5c38;
    border: 3px solid #5c3e24;
    box-shadow: 0 3px 0 #3b2912;
    color: #f6ecd9;
}

.control-buttons {
    display: flex;
}

.control-button {
    padding: 0.4rem 1rem;
    background-color: #cfb991;
    color: #5c3e24;
    border: 0;
    border-radius: 0;
    border-bottom: 3px solid #7d5c38;
    font-family: 'VT323', 'Microsoft YaHei', '微软雅黑', 'SimHei', '黑体', sans-serif;
    font-size: 1rem;
    cursor: pointer;
    margin-right: 0.5rem;
    text-shadow: 1px 1px 0 #e9daba;
}

.control-button:hover {
    background-color: #e3d2ac;
    transform: translateY(-2px);
}

.control-button:active {
    transform: translateY(2px);
    border-bottom-width: 1px;
}

/* 历史记录模态框 */
.history-modal-content {
    max-width: 600px;
    max-height: 80vh;
}

.history-container {
    max-height: 60vh;
    overflow-y: auto;
    padding: 1rem;
    background-color: #e9daba;
    border: 3px solid #7d5c38;
    margin-top: 1rem;
    white-space: pre-wrap;
    text-align: left;
}

.full-history {
    color: #3d2813;
    line-height: 1.6;
    font-size: 1.1rem;
}

/* 更新菜单按钮样式，匹配控制按钮 */
.menu-button {
    padding: 0.4rem 1rem;
    background-color: #8dc267;
    color: #f6ecd9;
    border: 0;
    border-radius: 0;
    border-bottom: 3px solid #5c8c3e;
    font-family: 'VT323', 'Microsoft YaHei', '微软雅黑', 'SimHei', '黑体', sans-serif;
    font-size: 1rem;
    cursor: pointer;
    text-shadow: 1px 1px 0 #3b591f;
}